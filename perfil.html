<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Perfil - Checkpoint</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&family=Press+Start+2P&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
  <style>
    /* === CSS DO PERFIL (compactado para brevidade) === */
    .profile-wrapper { display: flex; margin-top: 64px; min-height: calc(100vh - 64px); }
    .profile-sidebar { width: 280px; background: rgba(250,247,238,0.05); border-right: 1px solid rgba(250,247,238,0.1); padding: 40px 0; position: sticky; top: 64px; height: calc(100vh - 64px); overflow-y: auto; }
    .sidebar-nav { display: flex; flex-direction: column; gap: 8px; padding: 0 20px; }
    .sidebar-nav-item { padding: 16px 20px; border-radius: 10px; font-family: 'Montserrat', sans-serif; font-size: 15px; font-weight: 600; color: rgba(250,247,238,0.7); cursor: pointer; transition: all 0.3s ease; display: flex; align-items: center; gap: 12px; border: 2px solid transparent; }
    .sidebar-nav-item:hover { background: rgba(250,247,238,0.08); color: #FAF7EE; }
    .sidebar-nav-item.active { background: rgba(0,85,65,0.3); color: #FAF7EE; border-color: rgba(255,215,0,0.3); }
    .sidebar-nav-icon { font-size: 20px; }
    .profile-content { flex: 1; padding: 40px; max-width: 1400px; margin: 0 auto; width: 100%; }
    .content-section { display: none; animation: fadeIn 0.4s ease; }
    .content-section.active { display: block; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
    .profile-hero { position: relative; height: 280px; border-radius: 16px; overflow: hidden; margin-bottom: 100px; background: linear-gradient(135deg, #003d2e 0%, #005541 100%); }
    .profile-hero-cover { width: 100%; height: 100%; object-fit: cover; opacity: 0.3; }
    .profile-avatar-container { position: absolute; bottom: -80px; left: 40px; display: flex; align-items: flex-end; gap: 24px; }
    .profile-avatar { width: 160px; height: 160px; border-radius: 50%; border: 6px solid #005541; background: linear-gradient(135deg, #005541, #FFD700); display: flex; align-items: center; justify-content: center; font-size: 64px; box-shadow: 0 8px 24px rgba(0,0,0,0.5); }
    .profile-hero-info { margin-bottom: 20px; }
    .profile-username { font-family: 'Press Start 2P', cursive; font-size: 1.8rem; color: #FAF7EE; margin-bottom: 8px; }
    .profile-email { font-family: 'Montserrat', sans-serif; font-size: 14px; color: rgba(250,247,238,0.6); }
    .profile-info-card { background: rgba(250,247,238,0.05); border-radius: 12px; padding: 32px; border: 1px solid rgba(250,247,238,0.1); margin-bottom: 32px; }
    .profile-info-card h2 { font-family: 'Montserrat', sans-serif; font-size: 1.5rem; color: #FAF7EE; margin-bottom: 24px; display: flex; align-items: center; gap: 10px; }
    .profile-info-card h2::before { content: ''; width: 4px; height: 24px; background: #FFD700; border-radius: 2px; }
    .profile-form { display: flex; flex-direction: column; gap: 20px; }
    .form-group { display: flex; flex-direction: column; gap: 8px; }
    .form-label { font-family: 'Montserrat', sans-serif; font-size: 13px; font-weight: 600; color: rgba(250,247,238,0.7); text-transform: uppercase; letter-spacing: 0.5px; }
    .form-input { padding: 12px 16px; background: rgba(250,247,238,0.08); border: 2px solid rgba(250,247,238,0.2); border-radius: 8px; font-family: 'Montserrat', sans-serif; font-size: 15px; color: #FAF7EE; transition: all 0.3s ease; }
    .form-input:focus { outline: none; border-color: #FFD700; background: rgba(250,247,238,0.12); }
    .form-input:disabled { opacity: 0.5; cursor: not-allowed; }
    .form-actions { display: flex; gap: 12px; margin-top: 8px; }
    .btn { padding: 12px 24px; border-radius: 8px; font-family: 'Montserrat', sans-serif; font-size: 14px; font-weight: 600; cursor: pointer; transition: all 0.3s ease; border: 2px solid; }
    .btn-primary { background: #005541; border-color: #005541; color: #FAF7EE; }
    .btn-primary:hover { background: #007556; border-color: #007556; transform: translateY(-2px); }
    .btn-secondary { background: transparent; border-color: rgba(250,247,238,0.3); color: #FAF7EE; }
    .btn-secondary:hover { background: rgba(250,247,238,0.1); border-color: #FAF7EE; }
    .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 32px; }
    .stat-card { background: rgba(250,247,238,0.05); border-radius: 12px; padding: 24px; border: 1px solid rgba(250,247,238,0.1); text-align: center; transition: all 0.3s ease; }
    .stat-card:hover { background: rgba(250,247,238,0.08); transform: translateY(-4px); }
    .stat-number { font-family: 'Press Start 2P', cursive; font-size: 2rem; color: #FFD700; margin-bottom: 8px; }
    .stat-label { font-family: 'Montserrat', sans-serif; font-size: 13px; color: rgba(250,247,238,0.6); text-transform: uppercase; letter-spacing: 0.5px; }
    .activity-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 32px; flex-wrap: wrap; gap: 20px; }
    .activity-header h1 { font-family: 'Press Start 2P', cursive; font-size: 1.8rem; color: #FAF7EE; }
    .activity-filters { display: flex; gap: 12px; flex-wrap: wrap; }
    .filter-btn { padding: 10px 20px; background: rgba(250,247,238,0.05); border: 2px solid rgba(250,247,238,0.2); border-radius: 8px; font-family: 'Montserrat', sans-serif; font-size: 13px; font-weight: 600; color: rgba(250,247,238,0.7); cursor: pointer; transition: all 0.3s ease; }
    .filter-btn:hover { background: rgba(250,247,238,0.1); border-color: rgba(250,247,238,0.4); color: #FAF7EE; }
    .filter-btn.active { background: rgba(255,215,0,0.15); border-color: #FFD700; color: #FFD700; }
    .activity-timeline { position: relative; padding-left: 40px; }
    .activity-timeline::before { content: ''; position: absolute; left: 15px; top: 0; bottom: 0; width: 2px; background: rgba(250,247,238,0.1); }
    .activity-item { position: relative; margin-bottom: 32px; padding: 20px; background: rgba(250,247,238,0.05); border-radius: 12px; border: 1px solid rgba(250,247,238,0.1); transition: all 0.3s ease; }
    .activity-item:hover { background: rgba(250,247,238,0.08); transform: translateX(8px); }
    .activity-item::before { content: ''; position: absolute; left: -33px; top: 28px; width: 12px; height: 12px; background: #FFD700; border-radius: 50%; border: 3px solid #005541; }
    .activity-content { display: flex; gap: 20px; align-items: flex-start; }
    .activity-poster { width: 80px; height: 120px; border-radius: 8px; object-fit: cover; flex-shrink: 0; box-shadow: 0 4px 12px rgba(0,0,0,0.3); }
    .activity-details { flex: 1; }
    .activity-type { display: inline-block; padding: 4px 12px; background: rgba(255,215,0,0.15); border: 1px solid rgba(255,215,0,0.3); border-radius: 20px; font-family: 'Montserrat', sans-serif; font-size: 11px; font-weight: 600; color: #FFD700; text-transform: uppercase; margin-bottom: 8px; }
    .activity-text { font-family: 'Montserrat', sans-serif; font-size: 15px; color: #FAF7EE; margin-bottom: 8px; line-height: 1.6; }
    .activity-game-title { font-weight: 700; color: #FFD700; }
    .activity-timestamp { font-family: 'Montserrat', sans-serif; font-size: 12px; color: rgba(250,247,238,0.5); }
    .no-activity { text-align: center; padding: 60px 20px; color: rgba(250,247,238,0.6); font-family: 'Montserrat', sans-serif; }
    .friends-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 32px; }
    .friends-header h1 { font-family: 'Press Start 2P', cursive; font-size: 1.8rem; color: #FAF7EE; }
    .friends-search { padding: 10px 16px; background: rgba(250,247,238,0.08); border: 2px solid rgba(250,247,238,0.2); border-radius: 8px; font-family: 'Montserrat', sans-serif; font-size: 14px; color: #FAF7EE; width: 300px; }
    .friends-search:focus { outline: none; border-color: #FFD700; }
    .friends-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 20px; }
    .friend-card { background: rgba(250,247,238,0.05); border-radius: 12px; padding: 24px; border: 1px solid rgba(250,247,238,0.1); text-align: center; transition: all 0.3s ease; cursor: pointer; }
    .friend-card:hover { background: rgba(250,247,238,0.08); transform: translateY(-4px); border-color: rgba(255,215,0,0.3); }
    .friend-avatar { width: 80px; height: 80px; border-radius: 50%; background: linear-gradient(135deg, #005541, #FFD700); display: flex; align-items: center; justify-content: center; font-size: 32px; margin: 0 auto 16px; border: 3px solid rgba(250,247,238,0.1); }
    .friend-name { font-family: 'Montserrat', sans-serif; font-size: 15px; font-weight: 600; color: #FAF7EE; margin-bottom: 4px; }
    .friend-status { font-family: 'Montserrat', sans-serif; font-size: 12px; color: rgba(250,247,238,0.5); }
    @media (max-width: 768px) { .profile-wrapper { flex-direction: column; } .profile-sidebar { width: 100%; height: auto; position: static; padding: 20px 0; } .sidebar-nav { flex-direction: row; overflow-x: auto; padding: 0 20px; } .profile-content { padding: 20px; } }

    /* === CSS DO LOGIN (no final, sem conflitos) === */
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: 'Montserrat', sans-serif; background: linear-gradient(135deg, #001a14 0%, #003d2e 50%, #005541 100%); min-height: 100vh; }
    .login-container { max-width: 450px; width: 100%; background: rgba(250,247,238,0.05); backdrop-filter: blur(10px); border: 2px solid rgba(250,247,238,0.1); border-radius: 20px; padding: 40px; box-shadow: 0 20px 60px rgba(0,0,0,0.5); }
    .logo-section { text-align: center; margin-bottom: 32px; }
    .logo-title { font-family: 'Press Start 2P', cursive; font-size: 2rem; color: #FFD700; margin-bottom: 8px; text-shadow: 2px 2px 4px rgba(0,0,0,0.5); }
    .logo-subtitle { font-size: 14px; color: rgba(250,247,238,0.6); letter-spacing: 2px; }
    .tab-container { display: flex; gap: 8px; margin-bottom: 32px; background: rgba(250,247,238,0.05); padding: 6px; border-radius: 12px; }
    .tab-btn { flex: 1; padding: 12px; background: transparent; border: none; border-radius: 8px; font-family: 'Montserrat', sans-serif; font-size: 14px; font-weight: 600; color: rgba(250,247,238,0.6); cursor: pointer; transition: all 0.3s ease; }
    .tab-btn:hover { color: #FAF7EE; }
    .tab-btn.active { background: rgba(255,215,0,0.2); color: #FFD700; }
    .form-section { display: none; }
    .form-section.active { display: block; animation: fadeIn 0.3s ease; }
    .form-group { margin-bottom: 20px; }
    .form-label { display: block; font-size: 13px; font-weight: 600; color: rgba(250,247,238,0.8); margin-bottom: 8px; text-transform: uppercase; letter-spacing: 0.5px; }
    .form-input { width: 100%; padding: 14px 16px; background: rgba(250,247,238,0.08); border: 2px solid rgba(250,247,238,0.2); border-radius: 10px; font-family: 'Montserrat', sans-serif; font-size: 15px; color: #FAF7EE; transition: all 0.3s ease; }
    .form-input:focus { outline: none; border-color: #FFD700; background: rgba(250,247,238,0.12); }
    .form-input::placeholder { color: rgba(250,247,238,0.4); }
    .submit-btn { width: 100%; padding: 16px; background: linear-gradient(135deg, #005541, #007556); border: none; border-radius: 10px; font-family: 'Montserrat', sans-serif; font-size: 16px; font-weight: 700; color: #FAF7EE; cursor: pointer; transition: all 0.3s ease; text-transform: uppercase; letter-spacing: 1px; margin-top: 8px; }
    .submit-btn:hover:not(:disabled) { transform: translateY(-2px); box-shadow: 0 8px 20px rgba(0,85,65,0.4); }
    .submit-btn:disabled { opacity: 0.6; cursor: not-allowed; transform: none; }
    .error-message { background: rgba(220,38,38,0.2); border: 1px solid rgba(220,38,38,0.4); color: #fca5a5; padding: 12px; border-radius: 8px; margin-bottom: 20px; font-size: 14px; display: none; }
    .error-message.show { display: block; animation: shake 0.5s ease; }
    @keyframes shake { 0%,100% { transform: translateX(0); } 25% { transform: translateX(-10px); } 75% { transform: translateX(10px); } }
    .success-message { background: rgba(34,197,94,0.2); border: 1px solid rgba(34,197,94,0.4); color: #86efac; padding: 12px; border-radius: 8px; margin-bottom: 20px; font-size: 14px; display: none; }
    .success-message.show { display: block; animation: fadeIn 0.3s ease; }
    .password-requirements { font-size: 12px; color: rgba(250,247,238,0.5); margin-top: 4px; }
    .loading-spinner { display: inline-block; width: 16px; height: 16px; border: 2px solid rgba(250,247,238,0.3); border-radius: 50%; border-top-color: #FAF7EE; animation: spin 0.8s linear infinite; margin-right: 8px; }
    @keyframes spin { to { transform: rotate(360deg); } }
    @media (max-width: 480px) { .login-container { padding: 30px 20px; } .logo-title { font-size: 1.5rem; } }
  </style>
</head>
<body>
  <!-- HEADER (assumindo que styles.css tem o CSS dele) -->
  <header class="topbar">
    <div class="logo-container">
      <img src="logo_checkpoint.png" alt="Checkpoint Logo" class="logo-img">
      <span class="site-name">CHECKPOINT</span>
    </div>
    <nav class="nav-container">
      <a href="inicio.html" class="nav-btn">In√≠cio</a>
      <a href="index.html" class="nav-btn">Jogos</a>
      <a href="listas.html" class="nav-btn">Listas</a>
      <a href="perfil.html" class="nav-btn active">Perfil</a>
    </nav>
  </header>

  <!-- SE√á√ÉO DE LOGIN (vis√≠vel se n√£o logado) -->
  <div id="loginSection" style="min-height: calc(100vh - 64px); display: flex; align-items: center; justify-content: center; padding: 20px;">
    <div class="login-container">
      <div class="logo-section">
        <h1 class="logo-title">CHECKPOINT</h1>
        <p class="logo-subtitle">Sua comunidade de jogos</p>
      </div>

      <div class="tab-container">
        <button class="tab-btn active" data-tab="login">Login</button>
        <button class="tab-btn" data-tab="register">Registrar</button>
      </div>

      <div id="errorMessage" class="error-message"></div>
      <div id="successMessage" class="success-message"></div>

      <!-- Formul√°rio de Login -->
      <div id="loginForm" class="form-section active">
        <form>
          <div class="form-group">
            <label class="form-label">E-mail</label>
            <input type="email" class="form-input" id="loginEmail" placeholder="seu@email.com" required autocomplete="email">
          </div>
          <div class="form-group">
            <label class="form-label">Senha</label>
            <input type="password" class="form-input" id="loginPassword" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required minlength="6" autocomplete="current-password">
          </div>
          <button type="submit" class="submit-btn" id="loginBtn">Entrar</button>
        </form>
      </div>

      <!-- Formul√°rio de Registro -->
      <div id="registerForm" class="form-section">
        <form>
          <div class="form-group">
            <label class="form-label">Nome</label>
            <input type="text" class="form-input" id="registerName" placeholder="Seu nome" required>
          </div>
          <div class="form-group">
            <label class="form-label">E-mail</label>
            <input type="email" class="form-input" id="registerEmail" placeholder="seu@email.com" required autocomplete="email">
          </div>
          <div class="form-group">
            <label class="form-label">Senha</label>
            <input type="password" class="form-input" id="registerPassword" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required minlength="6" autocomplete="new-password">
            <div class="password-requirements">M√≠nimo de 6 caracteres</div>
          </div>
          <button type="submit" class="submit-btn" id="registerBtn">Criar Conta</button>
        </form>
      </div>
    </div>
  </div>

  <!-- CONTE√öDO DO PERFIL (vis√≠vel se logado) -->
  <div id="profileContent" style="display: none;">
    <div class="profile-wrapper">
      <!-- Sidebar -->
      <aside class="profile-sidebar">
        <nav class="sidebar-nav">
          <div class="sidebar-nav-item active" data-section="perfil">
            <span class="sidebar-nav-icon">üë§</span>
            <span>Perfil</span>
          </div>
          <div class="sidebar-nav-item" data-section="atividade">
            <span class="sidebar-nav-icon">üìä</span>
            <span>Atividade</span>
          </div>
          <div class="sidebar-nav-item" data-section="amigos">
            <span class="sidebar-nav-icon">üë•</span>
            <span>Amigos</span>
          </div>
        </nav>
      </aside>

      <!-- Conte√∫do Principal -->
      <main class="profile-content">
        <!-- SE√á√ÉO: PERFIL -->
        <section class="content-section active" id="perfil-section">
          <!-- Hero -->
          <div class="profile-hero">
            <img src="https://via.placeholder.com/1400x280/003d2e/003d2e" alt="Capa" class="profile-hero-cover">
            <div class="profile-avatar-container">
              <div class="profile-avatar">
                <span>üéÆ</span>
              </div>
              <div class="profile-hero-info">
                <h1 class="profile-username" id="displayUsername">GamerPro2024</h1>
                <p class="profile-email" id="displayEmail">gamer@checkpoint.com</p>
              </div>
            </div>
          </div>

          <!-- Estat√≠sticas -->
          <div class="stats-grid">
            <div class="stat-card">
              <div class="stat-number" id="statGamesPlayed">42</div>
              <div class="stat-label">Jogos Jogados</div>
            </div>
            <div class="stat-card">
              <div class="stat-number" id="statReviews">18</div>
              <div class="stat-label">Avalia√ß√µes</div>
            </div>
            <div class="stat-card">
              <div class="stat-number" id="statLists">5</div>
              <div class="stat-label">Listas Criadas</div>
            </div>
            <div class="stat-card">
              <div class="stat-number" id="statAvgRating">4.2</div>
              <div class="stat-label">Nota M√©dia</div>
            </div>
          </div>

          <!-- Informa√ß√µes Edit√°veis -->
          <div class="profile-info-card">
            <h2>Informa√ß√µes do Perfil</h2>
            <form class="profile-form" id="profileForm">
              <div class="form-group">
                <label class="form-label">Nome de Usu√°rio</label>
                <input type="text" class="form-input" id="usernameInput" value="GamerPro2024" disabled>
              </div>
              <div class="form-group">
                <label class="form-label">Email</label>
                <input type="email" class="form-input" id="emailInput" value="gamer@checkpoint.com" disabled>
              </div>
              <div class="form-actions">
                <button type="button" class="btn btn-primary" id="editBtn">Editar Perfil</button>
                <button type="button" class="btn btn-secondary" id="saveBtn" style="display: none;">Salvar Altera√ß√µes</button>
                <button type="button" class="btn btn-secondary" id="cancelBtn" style="display: none;">Cancelar</button>
              </div>
            </form>
          </div>
        </section>

        <!-- SE√á√ÉO: ATIVIDADE -->
        <section class="content-section" id="atividade-section">
          <div class="activity-header">
            <h1>Minha Atividade</h1>
            <div class="activity-filters">
              <button class="filter-btn active" data-period="todas">Todas</button>
              <button class="filter-btn" data-period="hoje">Hoje</button>
              <button class="filter-btn" data-period="semana">Esta Semana</button>
              <button class="filter-btn" data-period="mes">Este M√™s</button>
            </div>
          </div>
          <div class="activity-filters" style="margin-bottom: 24px;">
            <button class="filter-btn active" data-type="todos">Todos os Tipos</button>
            <button class="filter-btn" data-type="avaliacao">Avalia√ß√µes</button>
            <button class="filter-btn" data-type="jogo-adicionado">Jogos Adicionados</button>
            <button class="filter-btn" data-type="lista">Listas</button>
          </div>
          <div class="activity-timeline" id="activityTimeline">
            <!-- Atividades aqui -->
          </div>
        </section>

        <!-- SE√á√ÉO: AMIGOS -->
        <section class="content-section" id="amigos-section">
          <div class="friends-header">
            <h1>Meus Amigos</h1>
            <input type="text" class="friends-search" placeholder="Buscar amigos..." id="friendsSearch">
          </div>
          <div class="friends-grid" id="friendsGrid">
            <!-- Amigos aqui -->
          </div>
        </section>
      </main>
    </div>
  </div>

  <script>
    const API_URL = 'http://localhost:3000/api';

    // Fun√ß√µes auxiliares de mensagens
    function showError(message) {
      const errorDiv = document.getElementById('errorMessage');
      errorDiv.textContent = message;
      errorDiv.classList.add('show');
      setTimeout(() => errorDiv.classList.remove('show'), 5000);
    }

    function showSuccess(message) {
      const successDiv = document.getElementById('successMessage');
      successDiv.textContent = message;
      successDiv.classList.add('show');
      setTimeout(() => successDiv.classList.remove('show'), 3000);
    }

    function hideMessages() {
      document.getElementById('errorMessage').classList.remove('show');
      document.getElementById('successMessage').classList.remove('show');
    }

    // Altern√¢ncia de tabs (login/register)
    document.querySelectorAll('.tab-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        const targetTab = btn.dataset.tab;
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        document.querySelectorAll('.form-section').forEach(f => f.classList.remove('active'));
        btn.classList.add('active');
        document.getElementById(`${targetTab}Form`).classList.add('active');
        hideMessages();
      });
    });

    // Event listener para login
    document.getElementById('loginForm').addEventListener('submit', async (e) => {
      e.preventDefault();
      hideMessages();

      const email = document.getElementById('loginEmail').value;
      const senha = document.getElementById('loginPassword').value;
      const loginBtn = document.getElementById('loginBtn');

      if (!email || !senha) {
        showError('Por favor, preencha todos os campos.');
        return;
      }

      loginBtn.disabled = true;
      loginBtn.innerHTML = '<span class="loading-spinner"></span>Entrando...';

      try {
        const response = await fetch(`${API_URL}/usuarios/login`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ email, senha })
        });

        const data = await response.json();

        if (response.ok) {
          showSuccess('Login realizado com sucesso!');
          sessionStorage.setItem('userId', data.usuario.id);
          sessionStorage.setItem('userName', data.usuario.nome);
          sessionStorage.setItem('userEmail', data.usuario.email);
          sessionStorage.setItem('isLoggedIn', 'true');

          // Esconde login e mostra perfil (sem redirecionar)
          setTimeout(() => {
            document.getElementById('loginSection').style.display = 'none';
            document.getElementById('profileContent').style.display = 'block';
            loadUserProfile();
          }, 1000);
        } else {
          showError(data.erro || 'Erro ao fazer login. Tente novamente.');
        }
      } catch (error) {
        console.error('Erro ao fazer login:', error);
        showError('Erro ao conectar com o servidor. Verifique se o servidor est√° rodando.');
      } finally {
        loginBtn.disabled = false;
        loginBtn.innerHTML = 'Entrar';
      }
    });

    // Event listener para registro
    document.getElementById('registerForm').addEventListener('submit', async (e) => {
      e.preventDefault();
      hideMessages();

      const nome = document.getElementById('registerName').value;
      const email = document.getElementById('registerEmail').value;
      const senha = document.getElementById('registerPassword').value;
      const registerBtn = document.getElementById('registerBtn');

      if (!nome || !email || !senha) {
        showError('Por favor, preencha todos os campos.');
        return;
      }

      if (senha.length < 6) {
        showError('A senha deve ter no m√≠nimo 6 caracteres.');
        return;
      }

      registerBtn.disabled = true;
      registerBtn.innerHTML = '<span class="loading-spinner"></span>Criando conta...';

      try {
        const response = await fetch(`${API_URL}/usuarios/registrar`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ nome, email, senha })
        });

        const data = await response.json();

        if (response.ok) {
          showSuccess('Conta criada com sucesso! Fa√ßa login para continuar.');
          document.getElementById('registerForm').reset();
          setTimeout(() => {
            document.querySelector('[data-tab="login"]').click();
            document.getElementById('loginEmail').value = email;
          }, 2000);
        } else {
          showError(data.erro || 'Erro ao criar conta. Tente novamente.');
        }
      } catch (error) {
        console.error('Erro ao registrar:', error);
        showError('Erro ao conectar com o servidor. Verifique se o servidor est√° rodando.');
      } finally {
        registerBtn.disabled = false;
        registerBtn.innerHTML = 'Criar Conta';
      }
    });

    // Verifica√ß√£o de login no load da p√°gina
    window.addEventListener('load', () => {
      if (sessionStorage.getItem('isLoggedIn') === 'true') {
        document.getElementById('loginSection').style.display = 'none';
        document.getElementById('profileContent').style.display = 'block';
        loadUserProfile();
      } else {
        document.getElementById('loginSection').style.display = 'flex';
        document.getElementById('profileContent').style.display = 'none';
      }
    });

    // === SCRIPT DO PERFIL (dados mock e fun√ß√µes) ===
    // Dados mock (substitua por API)
    const userData = {
      username: "GamerPro2024",
      email: "gamer@checkpoint.com",
      stats: { gamesPlayed: 42, reviews: 18, lists: 5, avgRating: 4.2 }
    };
    const activitiesData = [
      {
        id: 1, type: "avaliacao", gameTitle: "Elden Ring", gamePoster: "https://via.placeholder.com/80x120/005541/FAF7EE?text=Elden+Ring",
        text: "Avaliou", rating: 5, timestamp: "2 horas atr√°s", date: new Date(Date.now() - 2 * 60 * 60 * 1000)
      }
    ];
    const friendsData = [{ id: 1, name: "samuca_bsb", avatar: "üéØ", status: "Desmaiado" }];

    let currentActivities = [...activitiesData];

    // Navega√ß√£o sidebar
    const sidebarItems = document.querySelectorAll('.sidebar-nav-item');
    const sections = document.querySelectorAll('.content-section');
    sidebarItems.forEach(item => {
      item.addEventListener('click', () => {
        const targetSection = item.dataset.section;
        sidebarItems.forEach(i => i.classList.remove('active'));
        sections.forEach(s => s.classList.remove('active'));
        item.classList.add('active');
        document.getElementById(`${targetSection}-section`).classList.add('active');
      });
    });

    // Edi√ß√£o de perfil
    const usernameInput = document.getElementById('usernameInput');
    const emailInput = document.getElementById('emailInput');
    const displayUsername = document.getElementById('displayUsername');
    const displayEmail = document.getElementById('displayEmail');
    const editBtn = document.getElementById('editBtn');
    const saveBtn = document.getElementById('saveBtn');
    const cancelBtn = document.getElementById('cancelBtn');
    let originalUsername = usernameInput.value;
    let originalEmail = emailInput.value;

    editBtn.addEventListener('click', () => {
      usernameInput.disabled = false;
      emailInput.disabled = false;
      editBtn.style.display = 'none';
      saveBtn.style.display = 'inline-block';
      cancelBtn.style.display = 'inline-block';
    });

    saveBtn.addEventListener('click', () => {
      displayUsername.textContent = usernameInput.value;
      displayEmail.textContent = emailInput.value;
      originalUsername = usernameInput.value;
      originalEmail = emailInput.value;
      usernameInput.disabled = true;
      emailInput.disabled = true;
      editBtn.style.display = 'inline-block';
      saveBtn.style.display = 'none';
      cancelBtn.style.display = 'none';
      alert('Perfil atualizado com sucesso!');
    });

    cancelBtn.addEventListener('click', () => {
      usernameInput.value = originalUsername;
      emailInput.value = originalEmail;
      usernameInput.disabled = true;
      emailInput.disabled = true;
      editBtn.style.display = 'inline-block';
      saveBtn.style.display = 'none';
      cancelBtn.style.display = 'none';
    });

    // Render atividades
    function renderActivities(activities) {
      const timeline = document.getElementById('activityTimeline');
      if (activities.length === 0) {
        timeline.innerHTML = '<div class="no-activity">Nenhuma atividade encontrada.</div>';
        return;
      }
      timeline.innerHTML = '';
      activities.forEach(activity => {
        const item = document.createElement('div');
        item.className = 'activity-item';
        let typeLabel = activity.type === 'avaliacao' ? '‚≠ê Avalia√ß√£o' : 'üéÆ Jogo';
        let activityHTML = `
          <div class="activity-content">
            ${activity.gamePoster ? `<img src="${activity.gamePoster}" alt="${activity.gameTitle}" class="activity-poster">` : ''}
            <div class="activity-details">
              <span class="activity-type">${typeLabel}</span>
              <p class="activity-text">
                ${activity.text} <span class="activity-game-title">${activity.gameTitle}</span>
                ${activity.rating ? ` com nota <span class="activity-game-title">${activity.rating}/5</span>` : ''}
              </p>
              <span class="activity-timestamp">${activity.timestamp}</span>
            </div>
          </div>
        `;
        item.innerHTML = activityHTML;
        timeline.appendChild(item);
      });
    }

    // Filtros de atividades
    document.querySelectorAll('[data-period]').forEach(btn => {
      btn.addEventListener('click', () => {
        document.querySelectorAll('[data-period]').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        filterActivities();
      });
    });
    document.querySelectorAll('[data-type]').forEach(btn => {
      btn.addEventListener('click', () => {
        document.querySelectorAll('[data-type]').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        filterActivities();
      });
    });

    function filterActivities() {
      const activePeriod = document.querySelector('[data-period].active').dataset.period;
      const activeType = document.querySelector('[data-type].active').dataset.type;
      let filtered = [...activitiesData];
      if (activePeriod !== 'todas') {
        const now = new Date();
        filtered = filtered.filter(activity => {
          const activityDate = activity.date;
          switch(activePeriod) {
            case 'hoje': return activityDate.toDateString() === now.toDateString();
            case 'semana': return activityDate >= new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000);
            case 'mes': return activityDate >= new Date(now.getTime() - 30 * 24 * 60 * 60 * 1000);
            default: return true;
          }
        });
      }
      if (activeType !== 'todos') {
        filtered = filtered.filter(activity => activity.type === activeType);
      }
      currentActivities = filtered;
      renderActivities(currentActivities);
    }

    // Render amigos
    function renderFriends(friends) {
      const grid = document.getElementById('friendsGrid');
      grid.innerHTML = '';
      friends.forEach(friend => {
        const card = document.createElement('div');
        card.className = 'friend-card';
        card.onclick = () => console.log('Navegar para perfil de:', friend.name);
        card.innerHTML = `
          <div class="friend-avatar"><span>${friend.avatar}</span></div>
          <div class="friend-name">${friend.name}</div>
          <div class="friend-status">${friend.status}</div>
        `;
        grid.appendChild(card);
      });
    }

    document.getElementById('friendsSearch').addEventListener('input', (e) => {
      const searchTerm = e.target.value.toLowerCase();
      const filtered = friendsData.filter(friend => friend.name.toLowerCase().includes(searchTerm));
      renderFriends(filtered);
    });

    renderFriends(friendsData);
    renderActivities(currentActivities);

    // Carregar perfil
    function loadUserProfile() {
      document.getElementById('statGamesPlayed').textContent = userData.stats.gamesPlayed;
      document.getElementById('statReviews').textContent = userData.stats.reviews;
      document.getElementById('statLists').textContent = userData.stats.lists;
      document.getElementById('statAvgRating').textContent = userData.stats.avgRating;
      document.getElementById('displayUsername').textContent = userData.username;
      document.getElementById('displayEmail').textContent = userData.email;
      document.getElementById('usernameInput').value = userData.username;
      document.getElementById('emailInput').value = userData.email;
    }
  </script>
</body>
</html>